<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <link rel="apple-touch-icon" sizes="76x76" th:href="@{/assets/img/apple-icon.png}">
    <link rel="icon" type="image/png" th:href="@{/assets/img/favicon.png}">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>
        Ease Management
    </title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
          name='viewport'/>
    <!-- Fonts and icons -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet"/>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <!-- CSS Files -->
    <link th:href="@{/assets/css/bootstrap.min.css}" rel="stylesheet"/>
    <link th:href="@{/assets/css/paper-dashboard.css}" rel="stylesheet"/>
    <link th:href="@{/assets/css/myProject.css}" rel="stylesheet"/>
    <link th:href="@{/assets/demo/demo.css}" rel="stylesheet"/>
    <link th:href="@{/assets/css/pagination.css}" rel="stylesheet"/>
    <link th:href="@{/assets/css/sidebar.css}" rel="stylesheet"/>
</head>
<body>
<div class="wrapper ">
    <div class="sidebar" data-color="white" data-active-color="danger">
        <div class="logo">
            <a class="simple-text logo-mini">
                <div class="logo-image-small">
                    <img th:src="@{/assets/img/apple-icon.png}">
                </div>
            </a>
            <a class="simple-text logo-normal">
                Ease Management
            </a>
        </div>
        <div class="sidebar-wrapper">
            <ul class="nav">
                <li class="active">
                    <a th:href="@{/myProject}">
                        <i class="nc-icon nc-paper"></i>
                        <p>My Project</p>
                    </a>
                </li>
                <li>
                    <a th:href="@{/view/dashboard}">
                        <i class="nc-icon nc-bank"></i>
                        <p>Dashboard</p>
                    </a>
                </li>
                <li>
                    <a th:href="@{/view/otherProjects}">
                        <i class="nc-icon nc-bullet-list-67"></i>
                        <p>Other Project</p>
                    </a>
                </li>
                <li>
                    <a th:href="@{/view/notifications}">
                        <i class="nc-icon nc-bell-55"></i>
                        <p>Notification</p>
                    </a>
                </li>
                <li>
                    <a th:href="@{/view/user}">
                        <i class="nc-icon nc-single-02"></i>
                        <p th:text="${username}"></p>
                    </a>
                </li>
                <li class="active-pro">
                    <a th:href="@{/view/upgrade}">
                        <i class="nc-icon nc-spaceship"></i>
                        <p>Upgrade to PRO</p>
                    </a>
                </li>
                <!-- 로그아웃 -->
                <li class="logout">
                    <a th:href="@{/logout}">
                        <i class="nc-icon nc-button-power"></i>
                        <p>Logout</p>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    <div class="main-panel">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-absolute fixed-top navbar-transparent">
            <div class="container-fluid">
                <div class="navbar-wrapper">
                    <a class="navbar-brand" href="javascript:;">My Project</a>
                </div>
                <div class="collapse navbar-collapse justify-content-end" id="navigation">
                    <form class="form-inline" style="margin-right: 20px; flex: 1;">
                        <div class="input-group no-border" style="width: 100%; max-width: 500px;">
                            <input type="text" class="form-control" placeholder="Search..." style="width: 100%;">
                            <div class="input-group-append">
                                <div class="input-group-text">
                                    <i class="nc-icon nc-zoom-split"></i>
                                </div>
                            </div>
                        </div>
                    </form>
                    <ul class="navbar-nav">
                        <li class="nav-item" style="margin-right: 15px;">
                            <a class="nav-link btn-magnify" href="javascript:;">
                                <i class="nc-icon nc-layout-11"></i>
                                <span class="d-lg-none d-md-block">Stats</span>
                            </a>
                        </li>
                        <li class="nav-item btn-rotate dropdown" style="margin-right: 15px;">
                            <a class="nav-link dropdown-toggle" href="javascript:;" id="navbarDropdownMenuLink"
                               data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="nc-icon nc-bell-55"></i>
                                <span class="d-lg-none d-md-block">Notifications</span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                                <a class="dropdown-item" href="#">Action</a>
                                <a class="dropdown-item" href="#">Another action</a>
                                <a class="dropdown-item" href="#">Something else here</a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link btn-rotate" href="javascript:;">
                                <i class="nc-icon nc-settings-gear-65"></i>
                                <span class="d-lg-none d-md-block">Account</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- End Navbar -->
        <div class="content">
            <!-- Flash 메시지 표시 영역 -->
            <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
                <span th:text="${errorMessage}"></span>
            </div>
            <div th:if="${successMessage}" class="alert alert-success" role="alert">
                <span th:text="${successMessage}"></span>
            </div>
            <div class="container">
                <div class="card">
                    <div class="card-header" style="background-color: #f7f7f7; border-bottom: 2px solid #ddd; border-top-left-radius: 10px; border-top-right-radius: 10px;">
                        <h4 class="card-title">Project Name: <span th:text="${project.projectName}">Project Name</span></h4>
                        <p class="card-category">Comprehensive details about the project</p>
                    </div>
                    <div class="card-body">
                        <!-- Project Details Section -->
                        <div class="row mb-4 pb-3" style="border-bottom: 1px solid #e0e0e0;">
                            <div class="col-md-6">
                                <h5>Description</h5>
                                <p th:text="${project.projectDescription}">Project Description</p>
                            </div>
                            <div class="col-md-6">
                                <h5>Project Leader</h5>
                                <p th:text="${project.teamLeader.username}">Project
                                    Leader</p>
                                <h5>Project Members</h5>
                                <p th:each="member : ${project.projectMembers}"> <!-- 리더를 제외하는 조건 -->
                                    <a th:href="@{/user/profile/{id}(id=${member.user.id})}"
                                       th:text="${member.user.username}"></a>
                                </p>
                            </div>
                        </div>

                        <div class="row mt-3 mb-4 pb-3" style="border-bottom: 1px solid #e0e0e0;">
                            <div class="col-md-6">
                                <h5>Start Date</h5>
                                <p th:text="${project.startDate}">Start Date</p>
                            </div>
                            <div class="col-md-6">
                                <h5>End Date</h5>
                                <p th:text="${project.endDate}">End Date</p>
                            </div>
                        </div>
                        <!-- Navigation Buttons -->
                        <div class="row mt-4">
                            <div class="col-md-3">
                                <button class="btn btn-info btn-block" onclick="location.href='projectBoard.html'">Project Board</button>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-warning btn-block" onclick="location.href='dashboard.html'">Go to Dashboard</button>
                            </div>
                            <div class="col-md-3">
                                <a class="btn btn-primary btn-block" th:href="@{/editProjectForm/{id}(id=${project.projectId})}">Edit Project</a>
                            </div>

                            <div class="col-md-3">
                                <button type="button" class="btn btn-warning btn-block" data-toggle="modal" data-target="#addTeamMemberModal">
                                    Add Team Member
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container mt-5">
                <!-- 공지사항 리스트 -->
                <div class="card">
                    <div class="card-header">
                        <h5>Project Announcements</h5>
                    </div>
                    <div class="card-body">
                        <ul class="list-group mb-3">
                            <li th:each="announcement : ${project.projectAnnouncements}" class="list-group-item">
                                <div>
                                    <h6 th:text="${announcement.title}">Announcement Title</h6>
                                    <p th:text="${announcement.content}">Announcement Content</p>
                                    <small class="text-muted">
                                        <strong>Author:</strong> <span
                                            th:text="${announcement.author.username}">Author Name</span>   |
                                        <strong>Created At:</strong> <span
                                            th:text="${announcement.createdAt}"></span>   |
                                        <strong>Last Updated:</strong> <span th:text="${announcement.updatedAt}"></span>
                                    </small>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="text-center mt-4">
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addAnnouncementModal">
                            Add Announcement
                        </button>
                    </div>
                </div>
                <!-- 버튼을 카드 외부로 이동 -->

            </div>

            <!-- 모달 창 컨테이너 -->
            <div class="container mt-4">

                <!-- 팀 멤버 추가 모달 창 -->
                <div class="modal fade" id="addTeamMemberModal" tabindex="-1" role="dialog" aria-labelledby="addTeamMemberModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="addTeamMemberModalLabel">Add Team Member</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form id="addMemberForm" th:action="@{/addTeamMember}" method="post">
                                    <div class="form-group">
                                        <label for="teamMemberEmail">Team Member Email</label>
                                        <input type="email" class="form-control" id="teamMemberEmail" name="email" required>
                                        <button type="button" class="btn btn-secondary mt-2" onclick="checkEmail()">Check Email</button>
                                        <small id="emailStatus" class="form-text text-muted"></small>
                                    </div>
                                    <input type="hidden" id="projectId" name="projectId" th:value="${project.projectId}">
                                    <button type="submit" class="btn btn-primary">Add Member</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 공지사항 글 추가 모달 창 -->
                <div class="modal fade" id="addAnnouncementModal" tabindex="-1" role="dialog" aria-labelledby="addAnnouncementModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="addAnnouncementModalLabel">Add New Announcement</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <form th:action="@{/addAnnouncement}" method="post">
                                    <div class="form-group">
                                        <label for="announcementTitle">Title</label>
                                        <input type="text" class="form-control" id="announcementTitle" name="title" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="announcementContent">Content</label>
                                        <textarea class="form-control" id="announcementContent" name="content" rows="4" required></textarea>
                                    </div>
                                    <input type="hidden" name="projectId" th:value="${project.projectId}">
                                    <button type="submit" class="btn btn-primary">Save</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <footer class="footer footer-black footer-white fixed-footer">
        <div class="container-fluid">
            <div class="row">
                <div class="credits ml-auto">
                        <span class="copyright">
                          © <script>
                            document.write(new Date().getFullYear())
                          </script>, made with <i class="fa fa-heart heart"></i> by E.M
                        </span>
                </div>
            </div>
        </div>
    </footer>
</div>
<!--   Core JS Files   -->
<script th:src="@{/assets/js/core/jquery.min.js}"></script>
<script th:src="@{/assets/js/core/popper.min.js}"></script>
<script th:src="@{/assets/js/core/bootstrap.min.js}"></script>
<!-- Include Perfect Scrollbar before paper-dashboard -->
<script th:src="@{/assets/js/plugins/perfect-scrollbar.jquery.min.js}"></script>
<!-- Chart JS -->
<script th:src="@{/assets/js/plugins/chartjs.min.js}"></script>
<!-- Main Dashboard Script -->
<script th:src="@{/assets/js/paper-dashboard.js}"></script>
<!--<script th:src="@{/assets/js/plugins/checkEmail.js}"></script>-->
</body>
</html>
